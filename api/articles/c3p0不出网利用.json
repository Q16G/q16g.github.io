{"title":"c3p0链不出网新利用","uid":"239654d5c9aacd2ba01291d95ccc8750","slug":"c3p0不出网利用","date":"2024-11-30T15:36:35.000Z","updated":"2025-06-26T09:53:44.890Z","comments":true,"path":"api/articles/c3p0不出网利用.json","keywords":null,"cover":[],"content":"<h1 id=\"c3p0不出网新利用\"><a href=\"#c3p0不出网新利用\" class=\"headerlink\" title=\"c3p0不出网新利用\"></a>c3p0不出网新利用</h1><h2 id=\"c3p0原理\"><a href=\"#c3p0原理\" class=\"headerlink\" title=\"c3p0原理\"></a>c3p0原理</h2><p>在<code>readObject</code>中调用了getObject<br><img src=\"/public/static/img/2024-11-30-23-43-44.png\"></p>\n<p>原生的可以打JNDI，也可以走到下面<code>ReferenceableUtils.referenceToObject</code>函数中<br><img src=\"/public/static/img/2024-11-30-23-44-46.png\"></p>\n<p>在这里可以打第二个链<code>urlClassLoader</code>，然后进行了factory的实例化，然后去调用了<code>getObjectInstance</code>方法<br><img src=\"/public/static/img/2024-11-30-23-46-03.png\"></p>\n<h2 id=\"不出网新利用\"><a href=\"#不出网新利用\" class=\"headerlink\" title=\"不出网新利用\"></a>不出网新利用</h2><p>由于链比较简单，所以就直接说不出网的新利用方式. 这里直接走到最后一个<code>getObjectInstace</code>.这里去找<code>factory.getObjectInstace</code>的实现，找到JavaBean工厂的实现。</p>\n<p>这里去看下<code>getObjectInstance</code>方法实现，代码比较通俗易懂，如果Map中有<code>JavaBeanReferenceMaker.REF_PROPS_KEY</code>的话，获取到value值，获取到<code>Content bytes</code>  然后进行反序列化。</p>\n<p><img src=\"/public/static/img/2024-11-30-23-53-29.png\"></p>\n<p>如果结合了其他依赖的话，也可以去打</p>\n","text":"c3p0不出网新利用c3p0原理在readObject中调用了getObject 原生的可以打JNDI，也可以走到下面ReferenceableUtils.referenceToObject函数中 在这里可以打第二个链urlClassLoader，然后进行了factory的实例化...","link":"","photos":[],"count_time":{"symbolsCount":413,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"JAVA安全","slug":"JAVA安全","count":1,"path":"api/tags/JAVA安全.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#c3p0%E4%B8%8D%E5%87%BA%E7%BD%91%E6%96%B0%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">c3p0不出网新利用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#c3p0%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">c3p0原理</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%8D%E5%87%BA%E7%BD%91%E6%96%B0%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">不出网新利用</span></a></li></ol></li></ol>","author":{"name":"Q16G","slug":"blog-author","avatar":"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230925201943513.png","link":"/","description":"Q16G","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"gogs-CVE-2025-47943漏洞复现","uid":"7d55e013b18c9fec141f6ee29b3992ce","slug":"gogs-CVE-2025-47943漏洞复现","date":"2025-06-26T06:51:10.000Z","updated":"2025-06-26T09:53:27.774Z","comments":true,"path":"api/articles/gogs-CVE-2025-47943漏洞复现.json","keywords":null,"cover":[],"text":"漏洞复现这是在2024年的暴露漏洞的payload。我们下面还会用到。 [core] repositoryformatversion &#x3D; 0 filemode &#x3D; true bare &#x3D; false logallrefupdates &#x3D; t...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"漏洞复现","slug":"漏洞复现","count":1,"path":"api/tags/漏洞复现.json"}],"author":{"name":"Q16G","slug":"blog-author","avatar":"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230925201943513.png","link":"/","description":"Q16G","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}}},"next_post":{}}