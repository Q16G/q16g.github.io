{"title":"exchange渗透","uid":"c4760e8d502d7930d4cada9eeea4a021","slug":"exchange渗透","date":"2023-07-15T13:31:45.000Z","updated":"2023-07-16T04:33:39.800Z","comments":true,"path":"api/articles/exchange渗透.json","keywords":null,"cover":[],"content":"<h1 id=\"内网渗透exchange\"><a href=\"#内网渗透exchange\" class=\"headerlink\" title=\"内网渗透exchange\"></a>内网渗透exchange</h1><p>常见的名词：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">DN:\nCN:\nOU:\nDC:\nACE: 访问控制项，用于定义对资源的访问权限。ACE包含了用户、组、权限等信息，以及表示是否允许或拒绝访问。\nACL: 访问控制列表，是一种存储ACE的数据结构。ACL用于管理对某个资源的访问权限，可以包含多个ACE。每个ACE定义一个特定的的访问控制规则。\nDACL：自主访问控制列表。DACL定义了对于一个对象的访问权限，拥有WriteDACL的用户才能进行修改对象的DACL，既可以修改或者撤销用户或者用户组对该对象的访问控制权限。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DCSYNC知识介绍\"><a href=\"#DCSYNC知识介绍\" class=\"headerlink\" title=\"DCSYNC知识介绍\"></a>DCSYNC知识介绍</h3><p>在域环境中，不同的域控制器之间，每15分钟都会有一次数据同步。DC1向其他域控制器获取数据的时候，DC1会向DC2发起一个GetNCChanges的请求，该请求包括同步的数据（这里就有问题，如果我们需要同步的是域用户密码，就会获取到）</p>\n<p>当获取了域内管理员权限，如果能修改域内普通用户权限，让其具有DCsync权限的话，那么普通用户也能导出域内用户的哈希。可以做隐蔽的权限维持。</p>\n<p>默认情况下，只有域控制器主机账号和域管理员能够dcsync，域管和邮件服务器的机器账号能有写ACL的权限，可以给指定用户添加dcsync来dump域的哈希。</p>\n<p>域内用户只需要拥有以下的两个权限就有dcsync的权限</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">‘DS-Replication-Get-Changes’     &#x3D; 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2\n‘DS-Replication-Get-Changes-All’ &#x3D; 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n\n\n<h3 id=\"没有Exchange凭证\"><a href=\"#没有Exchange凭证\" class=\"headerlink\" title=\"没有Exchange凭证\"></a>没有Exchange凭证</h3><p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230715220308890.png\" alt=\"image-20230715220308890\"></p>\n<p>除了默认的页面有登陆认证之外，如果我们需要爆破，还可以从这几个接口来进行爆破</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;ecp,&#x2F;ews,&#x2F;oab,&#x2F;owa,&#x2F;rpc,&#x2F;api,&#x2F;mapi,&#x2F;powershell,&#x2F;autodiscover,&#x2F;Microsoft-Server-ActiveSync<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这里我们推荐使用工具</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">https:&#x2F;&#x2F;github.com&#x2F;grayddq&#x2F;EBurst<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"rce漏洞（只需要普通用户凭证，不需要其他条件）\"><a href=\"#rce漏洞（只需要普通用户凭证，不需要其他条件）\" class=\"headerlink\" title=\"rce漏洞（只需要普通用户凭证，不需要其他条件）\"></a>rce漏洞（只需要普通用户凭证，不需要其他条件）</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">CVE-2020-0688、CVE-2020-17144<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n","feature":true,"text":"内网渗透exchange常见的名词： DN: CN: OU: DC: ACE: 访问控制项，用于定义对资源的访问权限。ACE包含了用户、组、权限等信息，以及表示是否允许或拒绝访问。 ACL: 访问控制列表，是一种存储ACE的数据结构。ACL用于管理对某个资源的访问权限，可以包含多...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"内网渗透","slug":"内网渗透","count":6,"path":"api/tags/内网渗透.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8Fexchange\"><span class=\"toc-text\">内网渗透exchange</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#DCSYNC%E7%9F%A5%E8%AF%86%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">DCSYNC知识介绍</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%B2%A1%E6%9C%89Exchange%E5%87%AD%E8%AF%81\"><span class=\"toc-text\">没有Exchange凭证</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#rce%E6%BC%8F%E6%B4%9E%EF%BC%88%E5%8F%AA%E9%9C%80%E8%A6%81%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E5%87%AD%E8%AF%81%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E5%85%B6%E4%BB%96%E6%9D%A1%E4%BB%B6%EF%BC%89\"><span class=\"toc-text\">rce漏洞（只需要普通用户凭证，不需要其他条件）</span></a></li></ol></li></ol></li></ol>","author":{"name":"Q16G","slug":"blog-author","avatar":"https://www.helloimg.com/images/2023/05/23/oJaeo5.jpg","link":"/","description":"一个潜心学习网络安全的大学生","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"字节序列问题","uid":"67ca9e91ec24db55ca87af66a3ba205d","slug":"字节序列问题","date":"2023-06-19T02:20:29.000Z","updated":"2023-06-23T07:47:41.984Z","comments":true,"path":"api/articles/字节序列问题.json","keywords":null,"cover":null,"text":"字节序的问题上次在内网穿透已经提到，字节序分为大端和小端，由于不同的芯片造成了不同的字节序列，例如X86是小端存储，System&#x2F;370，SPARC是大端存储，ARM是可以配置的。 引入不同地区和不同地区的人之间是存在方言的，同一地区由于方言相同，就可以完全通信，但是如...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"开发","slug":"开发","count":3,"path":"api/tags/开发.json"}],"author":{"name":"Q16G","slug":"blog-author","avatar":"https://www.helloimg.com/images/2023/05/23/oJaeo5.jpg","link":"/","description":"一个潜心学习网络安全的大学生","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}},"feature":true}}