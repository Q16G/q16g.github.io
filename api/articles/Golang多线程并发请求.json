{"title":"Golangå¤šçº¿ç¨‹å¹¶å‘å­¦ä¹ ","uid":"a52b5fed34208f47aa981d461e5d2476","slug":"Golangå¤šçº¿ç¨‹å¹¶å‘è¯·æ±‚","date":"2023-05-25T12:44:51.000Z","updated":"2023-05-26T07:59:18.484Z","comments":true,"path":"api/articles/Golangå¤šçº¿ç¨‹å¹¶å‘è¯·æ±‚.json","keywords":null,"cover":null,"content":"<h1 id=\"golangå¤šçº¿ç¨‹å¹¶å‘é—®é¢˜\"><a href=\"#golangå¤šçº¿ç¨‹å¹¶å‘é—®é¢˜\" class=\"headerlink\" title=\"golangå¤šçº¿ç¨‹å¹¶å‘é—®é¢˜\"></a>golangå¤šçº¿ç¨‹å¹¶å‘é—®é¢˜</h1><p>  åœ¨è¿™å‡ å¤©å†™golangçš„å¤šçº¿ç¨‹å¹¶å‘ä¸­ï¼Œé‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¹¶å‘ä¸ªæ•°æ§åˆ¶ï¼Œç¬¬äºŒä¸ªæ˜¯å½“è¿›è¡Œé«˜å¹¶å‘httpè¯·æ±‚çš„æ—¶å€™ï¼Œå¯¼è‡´è¿æ¥æ± çˆ†æ»¡è€Œæ— æ³•è¿›è¡Œæ­£å¸¸çš„è¯·æ±‚ã€‚è¿™é‡Œé‚åšä¸€ä¸ªè®°å½•ï¼Œé¡ºä¾¿å¯¹golangçš„httpè¯·æ±‚åº“ã€æ­£åˆ™åº“åšä¸€ä¸ªè¯¦ç»†ä»‹ç»ã€‚</p>\n<h1 id=\"net-x2F-HTTP\"><a href=\"#net-x2F-HTTP\" class=\"headerlink\" title=\"net&#x2F;HTTP\"></a>net&#x2F;HTTP</h1><p>httpè¯·æ±‚åº“æœ‰ä¸¤ç§è¯·æ±‚æ–¹å¼ï¼Œç›´æ¥è¯·æ±‚å’Œå®šä¹‰clientæ¥è¿›è¡Œè¯·æ±‚ï¼Œè¿™é‡Œæœ¬äººå–œæ¬¢å®šä¹‰clientæ¥è¿›è¡Œè¯·æ±‚ï¼Œå› ä¸ºclientä¸­å¯ä»¥è‡ªå®šä¹‰å¾ˆå¤šä¸œè¥¿ï¼Œè¿™é‡Œå°±è®°å½•ä¸€ç§å®šä¹‰clientçš„è¯·æ±‚æ–¹å¼ã€‚å®šä¹‰clientæ¥è¯·æ±‚ä¸€èˆ¬æœ‰å‡ ä¸ªæ­¥éª¤</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ï¼ˆ1ï¼‰å®šä¹‰transport\nï¼ˆ2ï¼‰å®šä¹‰clientå¹¶ä¸”æŠŠtransportå†™å…¥\nï¼ˆ3ï¼‰newrequestå‡ºæ¥ï¼Œå¦‚æœæ˜¯POSTè¯·æ±‚è®¾ç½®Content-Type\nï¼ˆ3ï¼‰ç”¨client.doæ¥è¿›è¡Œè§¦å‘httpè¯·æ±‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯¦è§£http.transportæ•°æ®ç»“æ„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">idleMuï¼šç©ºé—²è¿æ¥é”\ncloseIdleï¼šæ˜¯å¦å…³é—­æ‰€æœ‰ç©ºé—²è¿æ¥çš„æ ‡å¿—\nidleConnï¼šæœ€è¿‘ä½¿ç”¨çš„ç©ºé—²è¿æ¥\nidleConnWaitï¼šç­‰å¾…ç©ºé—²è¿æ¥çš„é˜Ÿåˆ—\nidleLRUï¼šè¿æ¥çš„LRUç®—æ³•\nreqMuï¼šè¯·æ±‚çš„äº’æ–¥é”\nreqCancelerï¼šå–æ¶ˆè¯·æ±‚çš„å‡½æ•°\naltMuï¼šå¤‡ç”¨åè®®çš„é”\naltProtoï¼šå¤‡ç”¨åè®®çš„å€¼ï¼Œå¯ä»¥ä¸ºnilæˆ–è€…map[string]RoundTripperï¼Œé”®ä¸ºURI scheme\nconnsPerHostMuï¼šå•ä¸ªä¸»æœºå†…è¿æ¥æ•°çš„é”\nconnsPerHostï¼šå•ä¸ªä¸»æœºå†…çš„è¿æ¥æ•°\nconnsPerHostWaitï¼šç­‰å¾…å•ä¸ªä¸»æœºå†…è¿æ¥çš„é˜Ÿåˆ—\nProxyï¼šè¿”å›ç»™å®šè¯·æ±‚çš„ä»£ç†çš„å‡½æ•°\nOnProxyConnectResponseï¼šå¤„ç†ä»£ç†çš„CONNECTè¯·æ±‚å“åº”çš„å‡½æ•°\nDialContextï¼šç”¨äºåˆ›å»ºéåŠ å¯†TCPè¿æ¥çš„æ‹¨å·å‡½æ•°\nDialï¼šåˆ›å»ºéåŠ å¯†TCPè¿æ¥çš„æ‹¨å·å‡½æ•°\nDialTLSContextï¼šç”¨äºåˆ›å»ºéä»£ç†HTTPSè¯·æ±‚çš„TLSè¿æ¥çš„å¯é€‰æ‹¨å·å‡½æ•°\nDialTLSï¼šç”¨äºåˆ›å»ºéä»£ç†HTTPSè¯·æ±‚çš„TLSè¿æ¥çš„å¯é€‰æ‹¨å·å‡½æ•°\nTLSClientConfigï¼šTLSé…ç½®ï¼Œç”¨äºtls.Client\nTLSHandshakeTimeoutï¼šTLSæ¡æ‰‹çš„æœ€é•¿ç­‰å¾…æ—¶é—´\nDisableKeepAlivesï¼šæ˜¯å¦ç¦æ­¢HTTP keep-aliveå’Œä»…ç”¨äºå•ä¸ªHTTPè¯·æ±‚çš„è¿æ¥\nDisableCompressionï¼šæ˜¯å¦ç¦æ­¢åœ¨è¯·æ±‚ä¸­ä½¿ç”¨gzipç¼–ç å‹ç¼©\nMaxIdleConnsï¼šæ‰€æœ‰ä¸»æœºä¸­ç©ºé—²ï¼ˆkeep-aliveï¼‰è¿æ¥çš„æœ€å¤§æ•°é‡\nMaxIdleConnsPerHostï¼šæ¯ä¸ªä¸»æœºä¸­ä¿ç•™çš„æœ€å¤§ç©ºé—²ï¼ˆkeep-aliveï¼‰è¿æ¥æ•°ï¼Œå¦‚æœä¸ºé›¶åˆ™ä½¿ç”¨é»˜è®¤å€¼\nMaxConnsPerHostï¼šæ¯ä¸ªä¸»æœºä¸­æœ€å¤šå…è®¸çš„è¿æ¥æ•°\nIdleConnTimeoutï¼šç©ºé—²ï¼ˆkeep-aliveï¼‰è¿æ¥çš„æœ€é•¿ç©ºé—²æ—¶é—´\nResponseHeaderTimeoutï¼šå‘é€è¯·æ±‚åç­‰å¾…æœåŠ¡å™¨å“åº”å¤´çš„æœ€é•¿æ—¶é—´\nExpectContinueTimeoutï¼šå¦‚æœè¯·æ±‚åŒ…å«â€œExpect: 100-continueâ€æ ‡å¤´ï¼Œåˆ™ç­‰å¾…æœåŠ¡å™¨ç¬¬ä¸€ä¸ªå“åº”å¤´çš„æœ€é•¿æ—¶é—´\nTLSNextProtoï¼šæŒ‡å®šTransportåœ¨TLS ALPNåè®®åå•†åå¦‚ä½•åˆ‡æ¢åˆ°å¤‡ç”¨åè®®çš„å‡½æ•°\nProxyConnectHeaderï¼šå‘é€åˆ°ä»£ç†æœåŠ¡å™¨çš„headers\nGetProxyConnectHeaderï¼šè¿”å›å‘é€åˆ°ä»£ç†æœåŠ¡å™¨çš„headersçš„å‡½æ•°\nMaxResponseHeaderBytesï¼šé™åˆ¶æœåŠ¡å™¨å“åº”å¤´çš„å­—èŠ‚æ•°\nWriteBufferSizeï¼šå†™ç¼“å†²åŒºçš„å¤§å°\nReadBufferSizeï¼šè¯»ç¼“å†²åŒºçš„å¤§å°\nnextProtoOnceï¼šTLSNextProtoå’Œh2transportï¼ˆé€šè¿‡onceSetNextProtoDefaultsåˆå§‹åŒ–ï¼‰çš„åˆå§‹åŒ–é”\nh2transportï¼šHTTP&#x2F;2ä¼ è¾“å±‚\ntlsNextProtoWasNilï¼šnextProtoOnceå‡½æ•°æ˜¯å¦è¢«è°ƒç”¨è¿‡<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­æˆ‘ç”¨åˆ°äº†transportä¸­çš„ä¸¤ä¸ª</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">DisableKeepAlivesï¼šç¦æ­¢é•¿è¿æ¥ï¼Œé¿å…å‡ºç°äº†å› ä¸ºè¿æ¥ä¸é‡Šæ”¾è€Œå¯¼è‡´è¿æ¥æ± çˆ†æ»¡çš„é—®é¢˜\nTLSClientConfigï¼šå…¶ä¸­ç”¨åˆ°äº†configä¸­çš„InsecureSkipVerifyï¼Œè¿™é‡Œçš„æ„æ€å°±æ˜¯ä¸åšhttpsçš„è¯ä¹¦æ ¡éªŒï¼Œä½¿å¾—è®¿é—®httpå’Œhttpsæ˜¯ç›¸åŒçš„<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"GETè¯·æ±‚ï¼š\"><a href=\"#GETè¯·æ±‚ï¼š\" class=\"headerlink\" title=\"GETè¯·æ±‚ï¼š\"></a>GETè¯·æ±‚ï¼š</h3><p>è¿™é‡Œåšä¸€ä¸ªç®€å•çš„è¿›è¡ŒGETè¯·æ±‚POSTè¯·æ±‚çš„å‘åŒ…ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">package main\n\nimport (\n\t&quot;crypto&#x2F;tls&quot;\n\t&quot;fmt&quot;\n\t&quot;io&quot;\n\t&quot;net&#x2F;http&quot;\n\t&quot;time&quot;\n)\n\nfunc main() &#123;\n\tTransport :&#x3D; &amp;http.Transport&#123;\n\t\tTLSClientConfig:   &amp;tls.Config&#123;InsecureSkipVerify: true&#125;,\n\t\tDisableKeepAlives: true,\n\t&#125;\n\tClient :&#x3D; &amp;http.Client&#123;\n\t\tTransport: Transport,\n\t\tTimeout:   time.Duration(time.Second * 3),\n\t&#125;\n\trequests, err :&#x3D; http.NewRequest(&quot;GET&quot;, &quot;http:&#x2F;&#x2F;baidu.com&#x2F;&quot;, nil)\n\trequests.Header.Set(&quot;User-Agent&quot;, &quot;Mozilla&#x2F;5.0 (Windows NT 6.1; WOW64) AppleWebKit&#x2F;535.1 (KHTML, like Gecko) Chrome&#x2F;14.0.835.163 Safari&#x2F;535.1&quot;)\n\tif err !&#x3D; nil &#123;\n\t\tfmt.Printf(&quot;err: %v\\n&quot;, err)\n\t\treturn\n\t&#125;\n\tr, err2 :&#x3D; Client.Do(requests)\n\tif err2 !&#x3D; nil &#123;\n\t\tfmt.Printf(&quot;err2: %v\\n&quot;, err2)\n\t\treturn\n\t&#125;\n\tdefer r.Body.Close()\n\tb, err3 :&#x3D; io.ReadAll(r.Body)\n\tif err3 !&#x3D; nil &#123;\n\t\tfmt.Printf(&quot;err3: %v\\n&quot;, err3)\n\t\treturn\n\t&#125;\n\tfmt.Printf(&quot;string(b): %v\\n&quot;, string(b))\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"POSTè¯·æ±‚ï¼š\"><a href=\"#POSTè¯·æ±‚ï¼š\" class=\"headerlink\" title=\"POSTè¯·æ±‚ï¼š\"></a>POSTè¯·æ±‚ï¼š</h3><p>é’ˆå¯¹POSTè¯·æ±‚å°±æœ‰å‡ ç§è¯´æ³•</p>\n<p>ï¼ˆ1ï¼‰ä¼ é€’çš„æ˜¯json  â€“&gt; Content-Typeç”¨jsonå½¢å¼ â€“&gt; ä¼ é€’æ•°æ®ä½¿ç”¨byteæµè¿›è¡Œå°è£…</p>\n<p>ï¼ˆ2ï¼‰ä¼ é€’çš„æ˜¯æ™®é€š â€“&gt; Content-Typeä½¿ç”¨æ™®é€šå½¢å¼ â€“&gt; ä¼ é€’æ•°æ®ä½¿ç”¨stringæµè¿›è¡Œå°è£…</p>\n","feature":true,"text":"golangå¤šçº¿ç¨‹å¹¶å‘é—®é¢˜ åœ¨è¿™å‡ å¤©å†™golangçš„å¤šçº¿ç¨‹å¹¶å‘ä¸­ï¼Œé‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¹¶å‘ä¸ªæ•°æ§åˆ¶ï¼Œç¬¬äºŒä¸ªæ˜¯å½“è¿›è¡Œé«˜å¹¶å‘httpè¯·æ±‚çš„æ—¶å€™ï¼Œå¯¼è‡´è¿æ¥æ± çˆ†æ»¡è€Œæ— æ³•è¿›è¡Œæ­£å¸¸çš„è¯·æ±‚ã€‚è¿™é‡Œé‚åšä¸€ä¸ªè®°å½•ï¼Œé¡ºä¾¿å¯¹golangçš„httpè¯·æ±‚åº“ã€æ­£åˆ™åº“åšä¸€ä¸ªè¯¦ç»†ä»‹ç»ã€‚ net&#x2F;HT...","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"å¼€å‘","slug":"å¼€å‘","count":1,"path":"api/tags/å¼€å‘.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#golang%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98\"><span class=\"toc-text\">golangå¤šçº¿ç¨‹å¹¶å‘é—®é¢˜</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#net-x2F-HTTP\"><span class=\"toc-text\">net&#x2F;HTTP</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#GET%E8%AF%B7%E6%B1%82%EF%BC%9A\"><span class=\"toc-text\">GETè¯·æ±‚ï¼š</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#POST%E8%AF%B7%E6%B1%82%EF%BC%9A\"><span class=\"toc-text\">POSTè¯·æ±‚ï¼š</span></a></li></ol></li></ol></li></ol>","author":{"name":"Q16G","slug":"blog-author","avatar":"https://www.helloimg.com/images/2023/05/23/oJaeo5.jpg","link":"/","description":"ä¸€ä¸ªæ½œå¿ƒå­¦ä¹ ç½‘ç»œå®‰å…¨çš„å¤§å­¦ç”Ÿ","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"å…³äºnpså·¥å…·çš„é­”æ”¹","uid":"badd5d9a02640c51cb699c12c4298740","slug":"å…³äºnpså·¥å…·çš„é­”æ”¹","date":"2023-05-26T07:52:53.000Z","updated":"2023-05-26T07:56:34.404Z","comments":true,"path":"api/articles/å…³äºnpså·¥å…·çš„é­”æ”¹.json","keywords":null,"cover":"https://k.sinaimg.cn/n/sinacn10110/470/w1170h900/20190411/7c33-hvntnkq4891892.jpg/w700d1q75cms.jpg","text":"å…è´£å£°æ˜ğŸ§æœ¬å·¥å…·ä»…é¢å‘ åˆæ³•æˆæƒ çš„ä¼ä¸šå®‰å…¨å»ºè®¾è¡Œä¸ºï¼Œå¦‚æ‚¨éœ€è¦æµ‹è¯•æœ¬å·¥å…·çš„å¯ç”¨æ€§ï¼Œè¯·è‡ªè¡Œæ­å»ºé¶æœºç¯å¢ƒã€‚ åœ¨ä½¿ç”¨æœ¬å·¥å…·è¿›è¡Œæ£€æµ‹æ—¶ï¼Œæ‚¨åº”ç¡®ä¿è¯¥è¡Œä¸ºç¬¦åˆå½“åœ°çš„æ³•å¾‹æ³•è§„ï¼Œå¹¶ä¸”å·²ç»å–å¾—äº†è¶³å¤Ÿçš„æˆæƒã€‚è¯·å‹¿å¯¹éæˆæƒç›®æ ‡è¿›è¡Œæ‰«æã€‚ å¦‚æ‚¨åœ¨ä½¿ç”¨æœ¬å·¥å…·çš„è¿‡ç¨‹ä¸­å­˜åœ¨ä»»ä½•éæ³•è¡Œä¸ºï¼Œæ‚¨éœ€è‡ªè¡Œæ‰¿æ‹…ç›¸åº”åæœï¼Œ...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"å·¥å…·é­”æ”¹","slug":"å·¥å…·é­”æ”¹","count":1,"path":"api/tags/å·¥å…·é­”æ”¹.json"}],"author":{"name":"Q16G","slug":"blog-author","avatar":"https://www.helloimg.com/images/2023/05/23/oJaeo5.jpg","link":"/","description":"ä¸€ä¸ªæ½œå¿ƒå­¦ä¹ ç½‘ç»œå®‰å…¨çš„å¤§å­¦ç”Ÿ","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"NTLM-Relayæ”»å‡»","uid":"87b274fadad0a6b05fd4814550be9f11","slug":"NTLM-Relayæ”»å‡»","date":"2023-05-24T04:12:28.000Z","updated":"2023-05-25T08:06:43.763Z","comments":true,"path":"api/articles/NTLM-Relayæ”»å‡».json","keywords":null,"cover":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201505%2F31%2F20150531134332_s4dxn.thumb.700_0.jpeg&refer=http%3A%2F%2Fb-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1687593990&t=c2298c6d35596afce3b266d2ab766151","text":"å‰è¨€ä»‹ç» NTLMè®¤è¯åˆ†ä¸ºæœ¬åœ°è®¤è¯å’Œç½‘ç»œè®¤è¯ï¼Œå½“æˆ‘ä»¬å¼€æœºç™»é™†ç”¨æˆ·è´¦å·çš„æ—¶å€™ï¼Œå°±éœ€è¦å°†lsassä¸­çš„å¯†ç è½¬æ¢ä¸ºæ˜æ–‡hashä¸samæ–‡ä»¶ä¸­è¿›è¡Œå¯¹æ¯”ï¼Œè¿™ç§æ–¹å¼å°±æ˜¯æœ¬åœ°è®¤è¯ã€‚ è€Œå½“æˆ‘ä»¬è®¿é—®å±€åŸŸç½‘ä¸­çš„ä¸€å°ä¸»æœºçš„SMBå…±äº«çš„æ—¶å€™ï¼Œéœ€è¦æä¾›å‡­è¯æ‰èƒ½è¿›è¡Œè®¿é—®ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ç½‘ç»œè®¤è¯ã€‚ NTLMåè®®...","link":"","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","count":2,"path":"api/tags/å†…ç½‘æ¸—é€.json"}],"author":{"name":"Q16G","slug":"blog-author","avatar":"https://www.helloimg.com/images/2023/05/23/oJaeo5.jpg","link":"/","description":"ä¸€ä¸ªæ½œå¿ƒå­¦ä¹ ç½‘ç»œå®‰å…¨çš„å¤§å­¦ç”Ÿ","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}},"feature":true}}